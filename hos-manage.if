####################################################
# MANAGE
####################################################
#---------------------------------------------------
interface(`hardhat_manage_chr_files_pattern',`
    allow $1 self:capability { mknod };
    hardhat_rw_dir_perms($1, $2)
    hardhat_manage_file_perms($1, $3, chr_file)
')
#---------------------------------------------------
interface(`hardhat_manage_dir_perms',`
    allow $1 $2:dir { create link lock rename reparent rmdir unlink };
    hardhat_list_dir_perms($1, $2)
    hardhat_rw_dir_perms($1, $2)
')
#---------------------------------------------------
interface(`hardhat_manage_dirs_pattern',`
    hardhat_rw_dir_perms($1, $2)
    hardhat_manage_dir_perms($1, $3)
')
#---------------------------------------------------
interface(`hardhat_manage_fifo_files_pattern',`
    hardhat_manage_file_perms($1, $3, fifo_file)
    hardhat_rw_dir_perms($1, $2)
')
#---------------------------------------------------
interface(`hardhat_manage_file_perms',`
    allow $1 $2:$3 { append create getattr link lock open read rename unlink write };
')
#---------------------------------------------------
interface(`hardhat_manage_files_pattern',`
    hardhat_manage_file_perms($1, $3, file)
    hardhat_rw_dir_perms($1, $2)
')
#---------------------------------------------------
interface(`hardhat_manage_lnk_files_pattern',`
    hardhat_manage_file_perms($1, $3, lnk_file)
    hardhat_rw_dir_perms($1, $2)
')
#---------------------------------------------------
interface(`hardhat_manage_sock_files_pattern',`
    hardhat_manage_file_perms($1, $3, sock_file)
    hardhat_rw_dir_perms($1, $2)
')
